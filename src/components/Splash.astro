---
interface Props {
	title?: string;
	role?: string;
	imageSrc?: string;
	imageAlt?: string;
}

const { title = 'Freelance', role = 'Software Development Engineer in Test', imageSrc = '/epic-freelancer.JPG', imageAlt = 'Epic freelancer' } = Astro.props;
---

<button id="splash" type="button" class="splash" aria-label="Click to enter">
	<img src={imageSrc} alt={imageAlt} loading="eager" fetchpriority="high" />
	<span class="splash-close" aria-hidden="true" title="Close">
		<svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
	</span>
	<span class="splash-title">{title}</span>
	<span class="splash-role">{role}</span>
</button>

<style>
	.splash {
		font-family: var(--font-display);
		position: fixed;
		inset: 0;
		z-index: 10001;
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--color-splash-bg);
		border: none;
		padding: 0;
		width: 100%;
		height: 100%;
		cursor: pointer;
		transition: opacity 0.4s ease-out;
		overflow: hidden;
		min-height: 100vh;
		min-height: 100dvh;
	}
	.splash.hidden {
		opacity: 0;
		pointer-events: none;
	}
	.splash.removed {
		display: none;
	}
	.splash img {
		width: 100%;
		height: 100%;
		min-width: 100%;
		min-height: 100%;
		object-fit: cover;
		object-position: 50% 35%;
		display: block;
		transition: filter 0.25s ease;
	}
	.splash.splash--cross-visible img {
		filter: brightness(0.85) saturate(0.8);
	}
	.splash-close {
		position: absolute;
		top: 1.5rem;
		right: 1.5rem;
		z-index: 2;
		color: var(--color-text);
		opacity: 0;
		transition: opacity 0.25s ease;
		pointer-events: none;
		filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.8));
	}
	.splash.splash--cross-visible .splash-close {
		opacity: 1;
	}
	.splash-title,
	.splash-role {
		position: absolute;
		margin: 0;
		font-weight: 400;
		color: var(--color-text);
		text-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
		pointer-events: none;
		z-index: 1;
	}
	.splash-title {
		top: 0;
		right: 1.5rem;
		left: 0.5rem;
		padding: 1rem 0 0.5rem;
		font-size: clamp(4rem, 22vw, 14rem);
		text-align: right;
	}
	.splash-role {
		right: 6.5rem;
		bottom: 5rem;
		padding: 1rem 0.5rem;
		font-size: clamp(1.5rem, 5vw, 2.2rem);
		white-space: nowrap;
		transform: rotate(90deg);
		transform-origin: right bottom;
	}
	@media (max-width: 480px) {
		.splash img {
			object-position: 50% 25%;
		}
		.splash-role {
			font-size: clamp(1.5rem, 7.5vw, 4rem);
			right: 4rem;
		}
	}
	@media (min-width: 481px) and (max-width: 1023px) {
		.splash img {
			object-position: 50% 32%;
		}
		.splash-title {
			font-size: clamp(4rem, 18vw, 12rem);
		}
		.splash-role {
			right: 5rem;
			bottom: 6rem;
			font-size: clamp(2rem, 4.5vw, 4rem);
		}
	}
	@media (min-width: 1024px) and (max-width: 1439px) {
		.splash img {
			object-position: center;
		}
		.splash-title {
			right: 6rem;
			font-size: clamp(4rem, 18vw, 8rem);
		}
	}
	@media (min-width: 1440px) {
		.splash img {
			object-position: center;
		}
		.splash-title {
			right: 12rem;
			font-size: clamp(6rem, 12vw, 14rem);
		}
		.splash-role {
			right: 8rem;
			bottom: 4rem;
			font-size: clamp(2rem, 5vw, 4rem);
		}
	}
	@media (max-height: 600px) {
		.splash img {
			object-position: 50% 40%;
		}
		.splash-title {
			padding: 0.5rem 0 0.25rem;
			font-size: clamp(2.5rem, 18vh, 6rem);
			right: 4rem;
		}
		.splash-role {
			bottom: 1rem;
			right: 4rem;
			font-size: clamp(0.9rem, 5vh, 1.5rem);
			padding: 0.25rem 0.5rem;
		}
	}
	@media (max-height: 400px) {
		.splash-title {
			font-size: clamp(2rem, 14vh, 4rem);
			right: 3rem;
		}
		.splash-role {
			right: 3rem;
			bottom: 0.5rem;
			font-size: clamp(0.75rem, 5vh, 1.25rem);
		}
	}
</style>

<script>
	const splash = document.getElementById('splash');
	const DISMISS_DURATION = 400;
	const CROSS_HIDE_DELAY = 5000;
	let crossHideTimeout: ReturnType<typeof setTimeout> | null = null;

	function dismiss() {
		if (!splash) return;
		splash.classList.add('hidden');
		splash.setAttribute('aria-hidden', 'true');
		document.documentElement.style.overflow = '';
		document.body.style.overflow = '';
		setTimeout(() => {
			splash.classList.add('removed');
		}, DISMISS_DURATION);
	}

	function showCross() {
		if (!splash) return;
		splash.classList.add('splash--cross-visible');
		if (crossHideTimeout) clearTimeout(crossHideTimeout);
		crossHideTimeout = setTimeout(() => {
			splash?.classList.remove('splash--cross-visible');
			crossHideTimeout = null;
		}, CROSS_HIDE_DELAY);
	}

	function hideCross() {
		if (!splash) return;
		splash.classList.remove('splash--cross-visible');
		if (crossHideTimeout) {
			clearTimeout(crossHideTimeout);
			crossHideTimeout = null;
		}
	}

	document.documentElement.style.overflow = 'hidden';
	document.body.style.overflow = 'hidden';

	splash?.addEventListener('click', dismiss);
	splash?.addEventListener('mouseenter', showCross);
	splash?.addEventListener('mousemove', showCross);
	splash?.addEventListener('mouseleave', hideCross);
</script>
